<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>PROGRESSIVE DISTILLATION FOR FAST SAMPLING OF DIFFUSION MODELS - ReadPapers</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="The note of Papers">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="theme/pagetoc.css">

        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><div>ReadPapers</div></li><li class="chapter-item expanded "><a href="index.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="3.html"><strong aria-hidden="true">2.</strong> On Distillation of Guided Diffusion Models</a></li><li class="chapter-item expanded "><a href="2.html"><strong aria-hidden="true">3.</strong> Denoising Diffusion Implicit Models</a></li><li class="chapter-item expanded "><a href="1.html" class="active"><strong aria-hidden="true">4.</strong> PROGRESSIVE DISTILLATION FOR FAST SAMPLING OF DIFFUSION MODELS</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">ReadPapers</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/CaterpillarStudyGroup/ReadPapers" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main><div class="sidetoc"><nav class="pagetoc"></nav></div>
                        <h1 id="æ ¸å¿ƒé—®é¢˜æ˜¯ä»€ä¹ˆ"><a class="header" href="#æ ¸å¿ƒé—®é¢˜æ˜¯ä»€ä¹ˆ">æ ¸å¿ƒé—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ</a></h1>
<p>DDPMçš„ç”Ÿæˆé€Ÿåº¦å¤ªæ…¢ã€‚</p>
<h1 id="ç›¸å…³å·¥ä½œchapter-6"><a class="header" href="#ç›¸å…³å·¥ä½œchapter-6">ç›¸å…³å·¥ä½œ(Chapter 6)</a></h1>
<p><strong>perform distillation of DDIM teacher models into one-step student models</strong></p>
<ul>
<li>Eric Luhman and Troy Luhman. Knowledge distillation in iterative generative models for improved sampling speed. arXiv preprint arXiv:2101.02388, 2021.</li>
</ul>
<p><strong>few-step sampling, as was the probability flow sampler</strong></p>
<ul>
<li>DDIM (Song et al., 2021a) was originally shown to be effective for few-step sampling, as was the probability flow sampler (Song et al., 2021c). </li>
<li>Jolicoeur-Martineau et al. (2021) study fast SDE integrators for reverse diffusion processes</li>
<li>Tzen &amp; Raginsky (2019b) study unbiased samplers which may be useful for fast, high quality sampling as well.</li>
</ul>
<p><strong>Other work on fast sampling can be viewed as manual or automated methods to adjust samplers or diffusion processes for fast generation.</strong> </p>
<ul>
<li>Nichol &amp; Dhariwal (2021); Kong &amp; Ping (2021) describe methods to adjust a discrete time diffusion model trained on many timesteps into models that can sample in few timesteps. </li>
<li>Watson et al. (2021) describe a dynamic programming algorithm to reduce the number of timesteps for a diffusion model in a way that is optimal for log likelihood. </li>
<li>Chen et al. (2021); Saharia et al. (2021); Ho et al. (2021) train diffusion models over continuous noise levels and tune samplers post training by adjusting the noise levels of a few-step discrete time reverse diffusion process. </li>
<li>Their method is effective in highly conditioned settings such as text-to-speech and image super-resolution. San-Roman et al. (2021) train a new network to estimate the noise level of noisy data and show how to use this estimate to speed up sampling.</li>
</ul>
<p><strong>Alternative specifications of the diffusion model can also lend themselves to fast sampling,</strong> </p>
<ul>
<li>modified forward and reverse processes (Nachmani et al., 2021; Lam et al., 2021) </li>
<li> training diffusion models in latent space (Vahdat et al., 2021).</li>
</ul>
<h1 id="æ ¸å¿ƒè´¡çŒ®æ˜¯ä»€ä¹ˆ"><a class="header" href="#æ ¸å¿ƒè´¡çŒ®æ˜¯ä»€ä¹ˆ">æ ¸å¿ƒè´¡çŒ®æ˜¯ä»€ä¹ˆï¼Ÿ</a></h1>
<p>åŠ é€ŸDDPMçš„ç”Ÿæˆè¿‡ç¨‹ã€‚</p>
<ol>
<li>we present new parameterizations of diffusion models that provide increased stability when using few sampling steps. </li>
<li>we present a method to distill a trained deterministic diffusion sampler. </li>
</ol>
<h1 id="å¤§è‡´æ–¹æ³•æ˜¯ä»€ä¹ˆ"><a class="header" href="#å¤§è‡´æ–¹æ³•æ˜¯ä»€ä¹ˆ">å¤§è‡´æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Ÿ</a></h1>
<p><img src="https://s.readpaper.com/T/2bF23cWDain" alt="d2a026851eebdc98f0b12efdc0b53a2c_1_Figure_1.png" /></p>
<blockquote>
<p>Figure 1: A visualization of two iterations of our proposed progressive distillation algorithm. A sampler f (z; Î·), mapping random noise  to samples x in 4 deterministic steps, is distilled into a new sampler f (z; Î¸) taking only a single step. The original sampler is derived by approximately integrating the probability flow ODE for a learned diffusion model, and distillation can thus be understood as learning to integrate in fewer steps, or amortizing this integration into the new sampler.</p>
</blockquote>
<p>âœ… å‡è®¾æœ‰ä¸€ä¸ª solverï¼Œå¯ä»¥æ ¹æ®$x_t$ é¢„æµ‹$x_{t-1}$ï¼<br />
âœ… è°ƒç”¨ä¸¤æ¬¡ solverï¼Œå¯ä»¥ä» $x_t$ å¾—åˆ°$x_{t-2}$ï¼Œå­¦ä¹ è¿™ä¸ªè¿‡ç¨‹ï¼Œå¯ä»¥ç›´æ¥å¾—åˆ° 2 step çš„ solver.<br />
âœ… å‰ä¸€ä¸ª solver ç§°ä¸º teacherï¼Œåä¸€ä¸ªç§°ä¸º student.<br />
âœ… student æˆä¸ºæ–°çš„ teacherï¼Œè®­ç»ƒæ–°çš„ student.</p>
<h1 id="æœ‰æ•ˆæ€§"><a class="header" href="#æœ‰æ•ˆæ€§">æœ‰æ•ˆæ€§</a></h1>
<p>On standard image generation benchmarks like CIFAR-10, ImageNet, and LSUN, we start out with state-of-the-art samplers taking as many as 8192 steps, and are able to distill down to models taking as few as 4 steps without losing much perceptual quality; achieving, for example, a FID of 3.0 on CIFAR-10 in 4 steps.</p>
<h1 id="ç¼ºé™·"><a class="header" href="#ç¼ºé™·">ç¼ºé™·</a></h1>
<table><thead><tr><th style="text-align: left">å±€é™</th><th style="text-align: left">æ”¹è¿›ç‚¹</th></tr></thead><tbody>
<tr><td style="text-align: left">In the current work we limited ourselves to setups where the student model has the same architecture and number of parameters as the teacher model:</td><td style="text-align: left">in future work we hope to relax this constraint and explore settings where the student model is smaller, potentially enabling further gains in test time computational requirements.</td></tr>
<tr><td style="text-align: left"></td><td style="text-align: left">In addition, we hope to move past the generation of images and also explore progressive distillation of diffusion models for different data modalities such as e.g. audio (Chen et al., 2021).</td></tr>
<tr><td style="text-align: left"></td><td style="text-align: left">In addition to the proposed distillation procedure, some of our progress was realized through different parameterizations of the diffusion model and its training loss. We expect to see more progress in this direction as the community further explores this model class.</td></tr>
</tbody></table>
<h1 id="éªŒè¯"><a class="header" href="#éªŒè¯">éªŒè¯</a></h1>
<h1 id="å¯å‘"><a class="header" href="#å¯å‘">å¯å‘</a></h1>
<ol>
<li>The resulting target value $\tilde x(z_t)$ is fully determined given the teacher model and starting point $z_t$, which allows the student model to make a sharp prediction when evaluated at$z_t$. In contrast, the original data point x is not fully determined given $z_t$, since multiple different data points x can produce the same noisy data $z_t$: this means that the original denoising model is predicting a weighted average of possible x values, which produces a blurry prediction. </li>
<li>å¯¹å™ªå£°æ±‚L2 losså¯ä»¥çœ‹ä½œæ˜¯åŠ æƒå¹³å‡çš„é‡å»ºL2 lossï¼Œæ¨å¯¼è¿‡ç¨‹è§å…¬å¼9ã€‚ä½†åœ¨distillationè¿‡ç¨‹ä¸­ï¼Œä¸é€‚åˆé¢„æµ‹å™ªå£°ï¼Œè€Œåº”è¯¥é‡å»ºã€‚</li>
<li>In practice, the choice of loss weighting also has to take into account how Î±t, Ïƒt are sampled during training, as this sampling distribution strongly determines the weight the expected loss gives to each signal-to-noise ratio.</li>
</ol>
<h1 id="é—ç•™é—®é¢˜"><a class="header" href="#é—ç•™é—®é¢˜">é—ç•™é—®é¢˜</a></h1>
<ol>
<li>å¾ˆå¤šç»†èŠ‚çœ‹ä¸æ‡‚ã€‚æ¯”å¦‚é¢„æµ‹xä¸é¢„æµ‹å™ªå£°çš„å…³ç³»ã€‚æ€ä¹ˆå®šä¹‰weight?parameterizations of the denoising diffusion model?DDIM?</li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="2.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="2.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script type="text/javascript">
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="theme/pagetoc.js"></script>


    </body>
</html>
